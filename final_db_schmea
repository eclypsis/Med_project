##FINAL DB SCHEMA
##DROP THE LAST AND USE THIS ONE
##FILL WITH DUMMIE DATA , FOR APP TESTING

#CREATE & USE MEDICINE_DB
DROP DATABASE MEDICINE_DB;
CREATE DATABASE MEDICINE_DB;
USE MEDICINE_DB;

#1. MEDICINE
CREATE TABLE MEDICINE(
MEDICINE_ID BIGINT NOT NULL AUTO_INCREMENT,
MEDICINE_KEY VARCHAR(100) NOT NULL UNIQUE,
NAME TEXT,
DESCRIPTION TEXT,
PRICE DOUBLE,
LICENSE TEXT,
VALID BOOLEAN,
QUANTITY INT,
PRIMARY KEY(MEDICINE_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#2. EFFECT
CREATE TABLE EFFECT(
EFFECT_ID BIGINT NOT NULL AUTO_INCREMENT,
DESCRIPTION TEXT,
PRIMARY KEY(EFFECT_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#3. PRODUCER
CREATE TABLE PRODUCER(
PRODUCER_ID BIGINT NOT NULL AUTO_INCREMENT,
NAME TEXT,
DESCRIPTION TEXT,
TEL TEXT,
EMAIL TEXT,
FAX TEXT,
ADDRESS TEXT,
PRIMARY KEY(PRODUCER_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#4. SIDE EFFECT
CREATE TABLE SIDE_EFFECT(
SIDE_EFFECT_ID BIGINT NOT NULL AUTO_INCREMENT,
DESCRIPTION TEXT,
PRIMARY KEY(SIDE_EFFECT_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#5. ACTIVE_SUBSTANCE
CREATE TABLE ACTIVE_SUBSTANCE(
ACTIVE_SUBSTANCE_ID BIGINT NOT NULL AUTO_INCREMENT,
ACTIVE_SUBSTANCE_KEY VARCHAR(100) NOT NULL UNIQUE,
ACTIVE_SUBSTANCE_NAME TEXT,
DESCRIPTION TEXT,
PRIMARY KEY(ACTIVE_SUBSTANCE_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#6. DOCTOR
CREATE TABLE DOCTOR(
DOCTOR_ID BIGINT NOT NULL AUTO_INCREMENT,
EMAIL_KEY VARCHAR(100) NOT NULL UNIQUE,
PASS_KEY TEXT NOT NULL,
FIRST_NAME TEXT,
LAST_NAME TEXT,
CATEGORY TEXT,
DATE_OF_BIRTH DATE,
TEL TEXT,
ADDRESS TEXT,
PRIMARY KEY(DOCTOR_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#7. PATIENT
CREATE TABLE PATIENT(
PATIENT_ID BIGINT NOT NULL AUTO_INCREMENT,
EMAIL_KEY VARCHAR(100) NOT NULL UNIQUE,
PASS_KEY TEXT NOT NULL,
FIRST_NAME TEXT,
LAST_NAME TEXT,
DATE_OF_BIRTH DATE,
TEL TEXT,
ADDRESS TEXT,
PRIMARY KEY(PATIENT_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#8. ROLE
CREATE TABLE ROLE(
ROLE_ID BIGINT NOT NULL AUTO_INCREMENT,
DESCRIPTION TEXT,
PRIMARY KEY(ROLE_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#9. MEDICINE_ACTIVE_SUBSTANCE
CREATE TABLE MEDICINE_ACTIVE_SUBSTANCE(
MEDICINE_ID BIGINT NOT NULL,
ACTIVE_SUBSTANCE_ID BIGINT NOT NULL,
PRIMARY KEY(MEDICINE_ID,ACTIVE_SUBSTANCE_ID),
FOREIGN KEY(MEDICINE_ID)REFERENCES MEDICINE(MEDICINE_ID),
FOREIGN KEY(ACTIVE_SUBSTANCE_ID)REFERENCES ACTIVE_SUBSTANCE(ACTIVE_SUBSTANCE_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#10. MEDICINE_PRODUCER
CREATE TABLE MEDICINE_PRODUCER(
MEDICINE_ID BIGINT NOT NULL,
PRODUCER_ID BIGINT NOT NULL,
PRIMARY KEY(MEDICINE_ID,PRODUCER_ID),
FOREIGN KEY(MEDICINE_ID)REFERENCES MEDICINE(MEDICINE_ID),
FOREIGN KEY(PRODUCER_ID)REFERENCES PRODUCER(PRODUCER_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#11. MEDICINE_EFFECT
CREATE TABLE MEDICINE_EFFECT(
MEDICINE_ID BIGINT NOT NULL,
EFFECT_ID BIGINT NOT NULL,
PRIMARY KEY(MEDICINE_ID,EFFECT_ID),
FOREIGN KEY(MEDICINE_ID)REFERENCES MEDICINE(MEDICINE_ID),
FOREIGN KEY(EFFECT_ID)REFERENCES EFFECT(EFFECT_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#12. DOCTOR_PATIENT
CREATE TABLE DOCTOR_PATIENT(
DOCTOR_ID BIGINT NOT NULL,
PATIENT_ID BIGINT NOT NULL,
PRIMARY KEY(DOCTOR_ID,PATIENT_ID),
FOREIGN KEY(DOCTOR_ID)REFERENCES DOCTOR(DOCTOR_ID),
FOREIGN KEY(PATIENT_ID)REFERENCES PATIENT(PATIENT_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#13. MEDICINE_SIDE_EFFECTIT 
CREATE TABLE MEDICINE_SIDE_EFFECT(
MEDICINE_ID BIGINT NOT NULL,
SIDE_EFFECT_ID BIGINT NOT NULL,
PRIMARY KEY(MEDICINE_ID,SIDE_EFFECT_ID),
FOREIGN KEY(MEDICINE_ID)REFERENCES MEDICINE(MEDICINE_ID),
FOREIGN KEY(SIDE_EFFECT_ID)REFERENCES SIDE_EFFECT(SIDE_EFFECT_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#14.PRESCRIPTION
CREATE TABLE PRESCRIPTION(
PRESCRIPTION_ID BIGINT NOT NULL AUTO_INCREMENT,
DOCTOR_ID BIGINT NOT NULL,
PATIENT_ID BIGINT NOT NULL,
DATE_OF_ISSUE DATE,
DESCRIPTION TEXT,
PRIMARY KEY(PRESCRIPTION_ID),
FOREIGN KEY(DOCTOR_ID) REFERENCES DOCTOR(DOCTOR_ID),
FOREIGN KEY(PATIENT_ID) REFERENCES PATIENT(PATIENT_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;

#15. MEDICINE_PRESCRIPTION
CREATE TABLE MEDICINE_PRESCRIPTION(
MEDICINE_ID BIGINT NOT NULL,
PRESCRIPTION_ID BIGINT NOT NULL,
QUANTITY INT,
PRIMARY KEY(MEDICINE_ID,PRESCRIPTION_ID),
FOREIGN KEY(MEDICINE_ID) REFERENCES MEDICINE(MEDICINE_ID),
FOREIGN KEY(PRESCRIPTION_ID) REFERENCES PRESCRIPTION(PRESCRIPTION_ID)
)ENGINE = INNODB DEFAULT CHARSET = UTF8;
